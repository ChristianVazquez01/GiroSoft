<ion-app>
  <div class="dashboard-container">
    <!-- Sidebar izquierdo estático -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>Panel</h2>
      </div>
      
      <ion-list class="menu-items" >
        <ion-item class="menu-item" (click)="nav('/panel')">
          <ion-icon name="home" slot="start"></ion-icon>
          <ion-label>Inicio</ion-label>
        </ion-item>
        
        <ion-item class="menu-item active"(click)="nav('/entrada')">
          <ion-icon name="add-sharp" slot="start"></ion-icon>
          <ion-label>Agregar material</ion-label>
        </ion-item>
        
        <ion-item class="menu-item" (click)="nav('/material')">
          <ion-icon name="cube" slot="start"></ion-icon>
          <ion-label>Materiales</ion-label>
        </ion-item>
        
        <ion-item class="menu-item"(click)="nav('/almacen')">
          <ion-icon name="archive" slot="start"></ion-icon>
          <ion-label>Almacén</ion-label>
        </ion-item>
        
        <!-- <ion-item class="menu-item"(click)="nav('/configuracion')">
          <ion-icon name="settings" slot="start"></ion-icon>
          <ion-label>Configuración</ion-label>
        </ion-item> -->
      </ion-list>
    </aside>

    <!-- Contenido principal -->
    <main class="main-content">
      <!-- Header -->
      <ion-header>
        <ion-toolbar>
          <img src="../../assets/icon/girolog.png" alt="">
          <ion-buttons slot="end">
            <ion-button>
              <ion-icon name="person-circle-outline"></ion-icon>
              <span>{{ nombreUsuario }}</span>
            </ion-button>
            <ion-button (click)="nav('/home')">
              <ion-icon name="log-out-outline" ></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content>
       <!-- AQUI PEGALO--> 
       



  <!-- FORMULARIO DE AGREGAR -->
  <ion-card *ngIf="!modoEdicion">
    <ion-card-content>
      <ion-list>
        <ion-item>
          <ion-label>Material</ion-label>
          <ion-select [(ngModel)]="nuevoRegistro.mat_id">
            <ion-select-option *ngFor="let m of materiales" [value]="m.mat_id">
              {{ m.mat_nombre }}
            </ion-select-option>
          </ion-select>
          <!-- <ion-input [(ngModel)]="nuevoMaterial.nombre" label="Nombre del material" placeholder="Ej: Cemento"></ion-input> -->
        </ion-item>
        <ion-item>
          <ion-input [(ngModel)]="nuevoRegistro.cantidad" type="number" label="Cantidad"></ion-input>
          <!-- <ion-input [(ngModel)]="nuevoMaterial.cantidad" type="number" label="Cantidad"></ion-input> -->
        </ion-item>
        <ion-item>
          <ion-label>Proveedor</ion-label>
          <ion-select (ionChange)="cargarProveedoresPorEmpresa($event)">
            <ion-select-option *ngFor="let p of proveedoresEmpresa" [value]="p.prov_empresa">
              {{ p.prov_empresa }}
            </ion-select-option>
          </ion-select>
          <!-- <ion-input [(ngModel)]="nuevoMaterial.proveedor" label="Proveedor"></ion-input> -->
        </ion-item>
        <ion-item>
          <ion-input [(ngModel)]="nuevoRegistro.fecha" type="date" label="Fecha de entrada"></ion-input>
          <!-- <ion-input [(ngModel)]="nuevoMaterial.fechaEntrada" type="date" label="Fecha de entrada"></ion-input> -->
        </ion-item>
        <ion-item>
          <ion-label>Recibido por</ion-label>
          <ion-select [(ngModel)]="nuevoRegistro.enc_id">
            <ion-select-option *ngFor="let e of encargados" [value]="e.enc_id">
              {{ e.enc_nombre }}
            </ion-select-option>
          </ion-select>
          <!-- <ion-input [(ngModel)]="nuevoMaterial.recibidoPor" label="Recibido por"></ion-input> -->
        </ion-item>
        <ion-item>
          <ion-label>Entregado por</ion-label>
          <ion-select [(ngModel)]="nuevoRegistro.prov_id">
            <ion-select-option *ngFor="let p of proveedores" [value]="p.prov_id">
              {{ p.prov_nombre }}
            </ion-select-option>
          </ion-select>
          <!-- <ion-input [(ngModel)]="nuevoMaterial.entregadoPor" label="Entregado por"></ion-input> -->
        </ion-item>
      </ion-list>
      <ion-button (click)="registrarEntrada()">Agregar Material</ion-button>
      <!-- <ion-button  (click)="agregarMaterial()">Agregar Material</ion-button> -->
    </ion-card-content>
  </ion-card>

  <!-- FORMULARIO DE EDICIÓN -->
  <ion-card *ngIf="modoEdicion">
    <ion-card-content>
      <h2>Editar registro</h2>

      <ion-item>
          <ion-label>Material</ion-label>
          <ion-input [(ngModel)]="registroEditando.mat_nombre" readonly></ion-input>
      </ion-item>

        <ion-item>
          <ion-input [(ngModel)]="registroEditando.reg_cantidad" type="number" label="Cantidad"></ion-input>
        </ion-item>

        <!-- <ion-item>
          <ion-input [(ngModel)]="materialEditando!.proveedor" label="Proveedor"></ion-input>
        </ion-item> -->

        <!-- <ion-item>
          <ion-input [(ngModel)]="registroEditando.reg_fecha" type="date" label="Fecha de entrada"></ion-input>
        </ion-item> -->

        <!-- <ion-item>
          <ion-input [(ngModel)]="materialEditando!.recibidoPor" label="Recibido por"></ion-input>
        </ion-item> -->
        <!-- <ion-item>
          <ion-input [(ngModel)]="materialEditando!.entregadoPor" label="Entregado por"></ion-input>
        </ion-item> -->

      <ion-button expand="block" (click)="guardarCambios()">Actualizar</ion-button>
      <ion-button expand="block" color="light" (click)="cancelarEdicion()">Cancelar</ion-button>
    </ion-card-content>
  </ion-card>

  <!-- LISTA DE MATERIALES -->
  <h2>Últimos registros agregados</h2>
  <ion-list *ngIf="ultimosRegistros.length > 0">

  <ion-card *ngFor="let item of ultimosRegistros">
    <ion-card-content>
      <h2><strong>{{ item.mat_nombre }} (x{{ item.reg_cantidad }})</strong></h2>
      <p>Proveedor: {{ item.prov_empresa }}</p>
      <p>Entregado por: {{ item.prov_nombre }}</p>
      <p>Fecha: {{ item.reg_fecha | date }}</p>
      <p>Recibido por: {{ item.enc_nombre }}</p>

      <div class="card-buttons">
        <ion-button size="small" color="primary" (click)="editarRegistro(item)">
          <ion-icon name="create-outline"></ion-icon>
        </ion-button>

        <ion-button size="small" color="danger" (click)="eliminarRegistro(item.reg_id)">
          <ion-icon name="trash-outline"></ion-icon>
        </ion-button>
      </div>

    </ion-card-content>
  </ion-card>

</ion-list>


      </ion-content>
    </main>
  </div>
</ion-app>